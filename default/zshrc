########## Aliases

alias ls="ls --color"

# Add an "alert" alias for long running commands. Use like so: "sleep 10; alert"
alias alert='notify-send --urgency=low -i "$([ $? = 0 ] && echo terminal || echo error)" "$(history|tail -n1|sed -e '\''s/^\s*[0-9]\+\s*//;s/[;&|]\s*alert$//'\'')"'

########## Configure editor

# Use vim keybinds
bindkey -v

# User-install bin
PATH="$HOME/bin":$PATH

if p=`command -v nvim`
then
	alias vi=$p
	alias vim=$p
	export VISUAL="$p"
else
	export VISUAL="vim"
fi

export EDITOR="$VISUAL"
export GIT_EDITOR="$VISUAL"

########## Open new terminal in current directory in MacOS

if [[ "$TERM_PROGRAM" == "Apple_Terminal" ]]; then
  function chpwd {
    printf '\e]7;%s\a' "file://$HOSTNAME${PWD// /%20}"
  }
  chpwd
fi

########### Load plugins

# source /etc/profile
source "$HOME/.slimzsh/slim.zsh"

_ANTIGEN_INSTALL_DIR=~/.antigen/
source $_ANTIGEN_INSTALL_DIR/bin/antigen.zsh

antigen bundle common-aliases
# antigen bundle zsh-users/zsh-completions
# antigen bundle zsh-users/zsh-autosuggestions
antigen bundle zsh-users/zsh-history-substring-search

antigen apply

########## Configure plugins

# history substring search
bindkey "$terminfo[kcuu1]" history-substring-search-up
bindkey "$terminfo[kcud1]" history-substring-search-down
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down
bindkey -M vicmd 'k' history-substring-search-up
bindkey -M vicmd 'j' history-substring-search-down

# Fix "git add" autocomplete hanging
__git_files () {
    _wanted files expl 'local files' _files
}

